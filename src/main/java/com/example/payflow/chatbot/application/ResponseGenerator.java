package com.example.payflow.chatbot.application;

import com.example.payflow.chatbot.domain.Intent;
import org.springframework.stereotype.Component;

import java.util.List;
import java.util.Map;
import java.util.Random;

@Component
public class ResponseGenerator {

    private final Random random = new Random();

    private final Map<Intent, List<String>> responses = Map.of(
        Intent.GREETING, List.of(
            "ì•ˆë…•í•˜ì„¸ìš”! PayFlow ì±—ë´‡ì…ë‹ˆë‹¤. ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”? ğŸ˜Š",
            "ë°˜ê°‘ìŠµë‹ˆë‹¤! ì£¼ë¬¸, ê²°ì œ, ë°°ì†¡, ì •ì‚° ê´€ë ¨ ë¬¸ì˜ë¥¼ ë„ì™€ë“œë¦½ë‹ˆë‹¤.",
            "ì•ˆë…•í•˜ì„¸ìš”! ê¶ê¸ˆí•˜ì‹  ì ì„ ë§ì”€í•´ì£¼ì„¸ìš”."
        ),
        Intent.ORDER_INQUIRY, List.of(
            "ì£¼ë¬¸ ì¡°íšŒëŠ” 'ë§ˆì´í˜ì´ì§€ > ì£¼ë¬¸ë‚´ì—­'ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì£¼ë¬¸ë²ˆí˜¸ë¥¼ ì•Œë ¤ì£¼ì‹œë©´ ë” ìì„¸íˆ ì•ˆë‚´í•´ë“œë¦´ê²Œìš”!",
            "ì£¼ë¬¸ ë‚´ì—­ì„ í™•ì¸í•˜ì‹œë ¤ë©´ ì£¼ë¬¸ë²ˆí˜¸ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì£¼ë¬¸ë²ˆí˜¸ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”."
        ),
        Intent.PAYMENT_INQUIRY, List.of(
            "ê²°ì œ ë‚´ì—­ì€ 'ë§ˆì´í˜ì´ì§€ > ê²°ì œë‚´ì—­'ì—ì„œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nê²°ì œ ê´€ë ¨ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ë§ì”€í•´ì£¼ì„¸ìš”.",
            "ê²°ì œ ì •ë³´ë¥¼ í™•ì¸í•˜ì‹œë ¤ë©´ ì£¼ë¬¸ë²ˆí˜¸ë‚˜ ê²°ì œë²ˆí˜¸ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”."
        ),
        Intent.DELIVERY_INQUIRY, List.of(
            "ë°°ì†¡ ì¡°íšŒëŠ” ì£¼ë¬¸ë²ˆí˜¸ë¡œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì£¼ë¬¸ë²ˆí˜¸ë¥¼ ì•Œë ¤ì£¼ì‹œë©´ ë°°ì†¡ ìƒíƒœë¥¼ í™•ì¸í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
            "ë°°ì†¡ ìƒíƒœê°€ ê¶ê¸ˆí•˜ì‹œêµ°ìš”! ì£¼ë¬¸ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì‹œë©´ ì‹¤ì‹œê°„ ë°°ì†¡ ì •ë³´ë¥¼ ì•Œë ¤ë“œë¦´ê²Œìš”."
        ),
        Intent.REFUND_REQUEST, List.of(
            "í™˜ë¶ˆ ìš”ì²­ì€ 'ë§ˆì´í˜ì´ì§€ > ì£¼ë¬¸ë‚´ì—­ > í™˜ë¶ˆì‹ ì²­'ì—ì„œ ê°€ëŠ¥í•©ë‹ˆë‹¤.\ní™˜ë¶ˆ ì‚¬ìœ ì™€ ì£¼ë¬¸ë²ˆí˜¸ë¥¼ ì•Œë ¤ì£¼ì‹œë©´ ë¹ ë¥´ê²Œ ì²˜ë¦¬í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
            "í™˜ë¶ˆ ì²˜ë¦¬ë¥¼ ë„ì™€ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ì£¼ë¬¸ë²ˆí˜¸ì™€ í™˜ë¶ˆ ì‚¬ìœ ë¥¼ ë§ì”€í•´ì£¼ì„¸ìš”."
        ),
        Intent.STAGE_INQUIRY, List.of(
            "ì •ì‚° ë‚´ì—­ì€ 'ì •ì‚°ê´€ë¦¬ > ì •ì‚°ì¡°íšŒ'ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\níŒë§¤ì ì •ì‚° ê´€ë ¨ ë¬¸ì˜ëŠ” ë³„ë„ë¡œ ì•ˆë‚´í•´ë“œë¦½ë‹ˆë‹¤.",
            "ì •ì‚° ì •ë³´ë¥¼ í™•ì¸í•˜ì‹œë ¤ë©´ ì •ì‚° ê¸°ê°„ì„ ì•Œë ¤ì£¼ì„¸ìš”."
        ),
        Intent.STAGE_GUIDE, List.of(
            "ğŸ¯ ìŠ¤í…Œì´ì§€(ê³„ëª¨ì„) ì´ìš© ë°©ë²•ì„ ì•ˆë‚´í•´ë“œë¦½ë‹ˆë‹¤!\n\n" +
            "ğŸ“Œ ìŠ¤í…Œì´ì§€ ìƒì„±í•˜ê¸°:\n" +
            "1. 'ìŠ¤í…Œì´ì§€ ëª©ë¡' í˜ì´ì§€ ì ‘ì†\n" +
            "2. 'ìƒˆ ìŠ¤í…Œì´ì§€ ë§Œë“¤ê¸°' í´ë¦­\n" +
            "3. ìƒí’ˆëª…, ê°€ê²©, ì°¸ì—¬ ì¸ì› ì…ë ¥\n" +
            "4. ìƒì„± ì™„ë£Œ!\n\n" +
            "ğŸ‘¥ ìŠ¤í…Œì´ì§€ ì°¸ì—¬í•˜ê¸°:\n" +
            "1. ì›í•˜ëŠ” ìŠ¤í…Œì´ì§€ ì„ íƒ\n" +
            "2. ìˆœë²ˆ ì„ íƒ (1ë²ˆë¶€í„° ì„ íƒ ê°€ëŠ¥)\n" +
            "3. 'ì°¸ì—¬í•˜ê¸°' í´ë¦­\n\n" +
            "ğŸš€ ìŠ¤í…Œì´ì§€ ì‹œì‘í•˜ê¸°:\n" +
            "- ëª¨ë“  ìˆœë²ˆì´ ì±„ì›Œì§€ë©´ ìë™ìœ¼ë¡œ ì‹œì‘ë©ë‹ˆë‹¤\n" +
            "- ê° ìˆœë²ˆë³„ë¡œ ê²°ì œ ë° ì•½ì •ê¸ˆ ì§€ê¸‰ì´ ì§„í–‰ë©ë‹ˆë‹¤\n\n" +
            "ë” ê¶ê¸ˆí•˜ì‹  ì ì´ ìˆìœ¼ì‹œë©´ ë§ì”€í•´ì£¼ì„¸ìš”!",
            "ìŠ¤í…Œì´ì§€ëŠ” ê³„ëª¨ì„ ë°©ì‹ì˜ ê³µë™êµ¬ë§¤ ì‹œìŠ¤í…œì…ë‹ˆë‹¤!\n\n" +
            "âœ¨ ì£¼ìš” íŠ¹ì§•:\n" +
            "â€¢ ì—¬ëŸ¬ ëª…ì´ í•¨ê»˜ ì°¸ì—¬í•˜ì—¬ ìˆœë²ˆëŒ€ë¡œ ìƒí’ˆ ìˆ˜ë ¹\n" +
            "â€¢ 1ë²ˆ ìˆœë²ˆë¶€í„° ì°¨ë¡€ëŒ€ë¡œ ì„ íƒ ê°€ëŠ¥\n" +
            "â€¢ ëª¨ë“  ì°¸ì—¬ìê°€ ëª¨ì´ë©´ ìë™ ì‹œì‘\n" +
            "â€¢ ì •ì‚° ë‚´ì—­ì€ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸ ê°€ëŠ¥\n\n" +
            "ìŠ¤í…Œì´ì§€ ëª©ë¡ í˜ì´ì§€ì—ì„œ ë°”ë¡œ ì‹œì‘í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!"
        ),
        Intent.HELP, List.of(
            "ì œê°€ ë„ì™€ë“œë¦´ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n" +
            "ğŸ“¦ ì£¼ë¬¸ ì¡°íšŒ ë° ê´€ë¦¬\n" +
            "ğŸ’³ ê²°ì œ ë‚´ì—­ í™•ì¸\n" +
            "ğŸšš ë°°ì†¡ ìƒíƒœ ì¡°íšŒ\n" +
            "ğŸ’° í™˜ë¶ˆ ë° ì·¨ì†Œ ì²˜ë¦¬\n" +
            "ğŸ¯ ìŠ¤í…Œì´ì§€ ì°¸ì—¬ ë° ì‹œì‘ ë°©ë²•\n" +
            "ğŸ“Š ì •ì‚° ë‚´ì—­ í™•ì¸\n\n" +
            "ê¶ê¸ˆí•˜ì‹  ë‚´ìš©ì„ ë§ì”€í•´ì£¼ì„¸ìš”!"
        ),
        Intent.UNKNOWN, List.of(
            "ì£„ì†¡í•©ë‹ˆë‹¤. ì§ˆë¬¸ì„ ì´í•´í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ğŸ˜…\në‹¤ì‹œ í•œë²ˆ ë§ì”€í•´ì£¼ì‹œê±°ë‚˜ 'ë„ì›€ë§'ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.",
            "ì˜ ì´í•´í•˜ì§€ ëª»í–ˆì–´ìš”. ì£¼ë¬¸, ê²°ì œ, ë°°ì†¡, í™˜ë¶ˆ, ì •ì‚° ì¤‘ ì–´ë–¤ ê²ƒì´ ê¶ê¸ˆí•˜ì‹ ê°€ìš”?",
            "ëª…í™•í•˜ê²Œ ì´í•´í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì¢€ ë” êµ¬ì²´ì ìœ¼ë¡œ ë§ì”€í•´ì£¼ì‹œê² ì–´ìš”?"
        )
    );

    public String generate(Intent intent) {
        List<String> intentResponses = responses.get(intent);
        if (intentResponses == null || intentResponses.isEmpty()) {
            return responses.get(Intent.UNKNOWN).get(0);
        }
        return intentResponses.get(random.nextInt(intentResponses.size()));
    }

    public String generateWithContext(Intent intent, String context) {
        String baseResponse = generate(intent);
        if (context != null && !context.isEmpty()) {
            return baseResponse + "\n\n" + context;
        }
        return baseResponse;
    }
}
