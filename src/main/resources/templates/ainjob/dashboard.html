<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AINJOB - HR SaaS í”Œë«í¼</title>
    <link rel="stylesheet" th:href="@{/css/ainjob.css}">
    <style th:replace="~{fragments/navigation :: nav-style}"></style>
</head>
<body>
    <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
    <header>
        <nav th:replace="~{fragments/navigation :: nav}"></nav>
    </header>
    
    <div class="ainjob-container">
        <!-- í—¤ë” -->
        <div class="ainjob-header">
            <h1>ğŸ¯ AINJOB HR SaaS í”Œë«í¼</h1>
            <p>ì±„ìš© ê³µê³  ê´€ë¦¬ë¶€í„° ì§€ì›ì ì¶”ì ê¹Œì§€ - í†µí•© ì¸ì‚¬ ê´€ë¦¬ ì‹œìŠ¤í…œ</p>
        </div>
        
        <!-- ëŒ€ì‹œë³´ë“œ ì¹´ë“œ -->
        <div class="dashboard-grid">
            <div class="dashboard-card" onclick="location.href='/ainjob/applicants'">
                <div class="dashboard-card-icon">ğŸ‘¥</div>
                <div class="dashboard-card-title">ì§€ì›ì ê´€ë¦¬</div>
                <div class="dashboard-card-count" id="applicant-count">-</div>
                <div class="dashboard-card-desc">ë“±ë¡ëœ ì§€ì›ì</div>
            </div>
            
            <div class="dashboard-card" onclick="location.href='/ainjob/job-postings'">
                <div class="dashboard-card-icon">ğŸ“‹</div>
                <div class="dashboard-card-title">ì±„ìš© ê³µê³ </div>
                <div class="dashboard-card-count" id="job-posting-count">-</div>
                <div class="dashboard-card-desc">ì§„í–‰ ì¤‘ì¸ ê³µê³ </div>
            </div>
            
            <div class="dashboard-card" onclick="location.href='/ainjob/applications'">
                <div class="dashboard-card-icon">ğŸ“</div>
                <div class="dashboard-card-title">ì§€ì› ë‚´ì—­</div>
                <div class="dashboard-card-count" id="application-count">-</div>
                <div class="dashboard-card-desc">ì´ ì§€ì› ê±´ìˆ˜</div>
            </div>
            
            <div class="dashboard-card">
                <div class="dashboard-card-icon">âœ…</div>
                <div class="dashboard-card-title">í•©ê²©ì</div>
                <div class="dashboard-card-count" id="pass-count">-</div>
                <div class="dashboard-card-desc">ìµœì¢… í•©ê²©ì</div>
            </div>
        </div>
        
        <!-- ë¹ ë¥¸ ì•¡ì…˜ -->
        <div class="table-container">
            <div class="table-header">
                <h2 class="table-title">ë¹ ë¥¸ ì‹œì‘</h2>
            </div>
            <div class="btn-group">
                <button class="btn-primary" onclick="location.href='/ainjob/applicants/create'">
                    â• ì§€ì›ì ë“±ë¡
                </button>
                <button class="btn-primary" onclick="location.href='/ainjob/job-postings/create'">
                    ğŸ“ ì±„ìš© ê³µê³  ì‘ì„±
                </button>
                <button class="btn-secondary" onclick="location.href='/ainjob/applicants'">
                    ğŸ‘¥ ì§€ì›ì ëª©ë¡
                </button>
                <button class="btn-secondary" onclick="location.href='/ainjob/job-postings'">
                    ğŸ“‹ ê³µê³  ëª©ë¡
                </button>
            </div>
        </div>
        
        <!-- ìµœê·¼ ì§€ì› ë‚´ì—­ -->
        <div class="table-container" style="margin-top: 24px;">
            <div class="table-header">
                <h2 class="table-title">ìµœê·¼ ì§€ì› ë‚´ì—­</h2>
                <button class="btn-secondary" onclick="location.href='/ainjob/applications'">
                    ì „ì²´ ë³´ê¸° â†’
                </button>
            </div>
            <div id="recent-applications">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                </div>
            </div>
        </div>
    </div>
    
    <script th:replace="~{fragments/navigation :: nav-script}"></script>
    <script>
        // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
        async function loadDashboardData() {
            try {
                // ì§€ì›ì ìˆ˜
                const applicantsRes = await fetch('/api/ainjob/applicants');
                if (applicantsRes.ok) {
                    const applicants = await applicantsRes.json();
                    document.getElementById('applicant-count').textContent = applicants.length;
                }
                
                // ì±„ìš© ê³µê³  ìˆ˜
                const jobPostingsRes = await fetch('/api/ainjob/job-postings');
                if (jobPostingsRes.ok) {
                    const jobPostings = await jobPostingsRes.json();
                    document.getElementById('job-posting-count').textContent = 
                        jobPostings.filter(jp => jp.status === 'OPEN').length;
                }
                
                // ìµœê·¼ ì§€ì› ë‚´ì—­ (ì„ì‹œ ë°ì´í„°)
                document.getElementById('recent-applications').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“­</div>
                        <div class="empty-state-title">ì•„ì§ ì§€ì› ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</div>
                        <div class="empty-state-desc">ì§€ì›ìë¥¼ ë“±ë¡í•˜ê³  ì±„ìš© ê³µê³ ì— ì§€ì›í•´ë³´ì„¸ìš”</div>
                    </div>
                `;
                
                document.getElementById('application-count').textContent = '0';
                document.getElementById('pass-count').textContent = '0';
                
            } catch (error) {
                console.error('ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('applicant-count').textContent = '0';
                document.getElementById('job-posting-count').textContent = '0';
                document.getElementById('application-count').textContent = '0';
                document.getElementById('pass-count').textContent = '0';
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ
        window.addEventListener('load', loadDashboardData);
    </script>
</body>
</html>
