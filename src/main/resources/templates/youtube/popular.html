<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko"></html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube 인기 급상승 영상</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
    <link rel="stylesheet" th:href="@{/css/youtube-popular.css}">
    <link rel="stylesheet" th:href="@{/css/youtube-chat.css}">
</head>
<body>
    <header class="youtube-header">
        <div class="header-content">
            <a href="/youtube/popular" class="logo">
                <span class="youtube-icon">
                    <svg viewBox="0 0 120 84" fill="#FF0000" xmlns="http://www.w3.org/2000/svg">
                        <path d="M117.5 13.125C116.062 7.875 111.375 3.375 106.25 2.125C97 0.875 60 0.875 60 0.875C60 0.875 23 0.875 13.75 2.125C8.625 3.375 3.9375 7.875 2.5 13.125C1.25 18.5 1.25 31.5 1.25 31.5C1.25 31.5 1.25 44.5 2.5 49.875C3.9375 55.125 8.625 59.625 13.75 60.875C23 62.125 60 62.125 60 62.125C60 62.125 97 62.125 106.25 60.875C111.375 59.625 116.062 55.125 117.5 49.875C118.75 44.5 118.75 31.5 118.75 31.5C118.75 31.5 118.75 18.5 117.5 13.125Z"/>
                        <path d="M48.125 44.25L78.125 31.5L48.125 18.75V44.25Z" fill="white"/>
                    </svg>
                </span>
                YouTube 트렌드
            </a>
        </div>
    </header>

    <div class="container">
        <div class="page-header">
            <h1>
                <span class="material-symbols-outlined fire-icon">local_fire_department</span>
                YouTube 인기 급상승
            </h1>
            <p>실시간 인기 영상을 확인하세요</p>
        </div>

        <!-- 검색 섹션 -->
        <div class="search-section">
            <div class="search-box">
                <input type="text" id="searchQuery" placeholder="검색어를 입력하세요..." onkeypress="handleSearchKeypress(event)">
                <button class="btn-search" onclick="searchVideos()">
                    <span class="material-symbols-outlined">search</span>
                    검색
                </button>
            </div>
        </div>

        <!-- 탭 & 필터 -->
        <div class="controls-section">
            <div class="tab-menu">
                <div class="tab-buttons">
                    <button class="tab-btn active" data-tab="popular" onclick="switchTab('popular')">
                        <span class="material-symbols-outlined">local_fire_department</span>
                        인기 급상승
                    </button>
                    <button class="tab-btn" data-tab="search" onclick="switchTab('search')">
                        <span class="material-symbols-outlined">search</span>
                        검색 결과
                    </button>
                    <button class="tab-btn" data-tab="favorites" onclick="switchTab('favorites')">
                        <span class="material-symbols-outlined">folder_special</span>
                        즐겨찾기
                    </button>
                </div>
                <button class="btn-refresh" onclick="loadCurrentTab()">
                    <span class="material-symbols-outlined">refresh</span>
                    새로고침
                </button>
            </div>

            <div class="filter-section" id="regionFilter">
                <div class="filter-group">
                    <label for="regionCode">국가:</label>
                    <select id="regionCode">
                        <option value="KR" selected>🇰🇷 한국</option>
                        <option value="US">🇺🇸 미국</option>
                        <option value="JP">🇯🇵 일본</option>
                        <option value="GB">🇬🇧 영국</option>
                        <option value="DE">🇩🇪 독일</option>
                        <option value="FR">🇫🇷 프랑스</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="maxResults">개수:</label>
                    <select id="maxResults">
                        <option value="10">10개</option>
                        <option value="25" selected>25개</option>
                        <option value="50">50개</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- 크리에이터 인사이트 섹션 -->
        <div id="insights-section" class="insights-section" style="display: none;">
            <div class="insights-header">
                <h1>크리에이터 인사이트</h1>
                <p>인기 영상 데이터를 분석한 트렌드 정보</p>
            </div>
            
            <!-- 메트릭 카드 그리드 -->
            <div class="insights-grid">
                <div class="insight-card">
                    <div class="insight-card-header">
                        <span class="material-symbols-outlined">local_fire_department</span>
                        <span>인기 키워드</span>
                    </div>
                    <div class="insight-value-large" id="insight-keywords">-</div>
                </div>
                <div class="insight-card">
                    <div class="insight-card-header">
                        <span class="material-symbols-outlined">schedule</span>
                        <span>평균 영상 길이</span>
                    </div>
                    <div class="insight-value-xl" id="insight-duration">-</div>
                </div>
                <div class="insight-card">
                    <div class="insight-card-header">
                        <span class="material-symbols-outlined">thumb_up</span>
                        <span>평균 참여율</span>
                    </div>
                    <div class="insight-value-xl" id="insight-engagement">-</div>
                </div>
                <div class="insight-card">
                    <div class="insight-card-header">
                        <span class="material-symbols-outlined">visibility</span>
                        <span>평균 조회수</span>
                    </div>
                    <div class="insight-value-xl" id="insight-views">-</div>
                </div>
                <div class="insight-card">
                    <div class="insight-card-header">
                        <span class="material-symbols-outlined">title</span>
                        <span>평균 제목 길이</span>
                    </div>
                    <div class="insight-value-xl" id="insight-title-length">-</div>
                </div>
                <div class="insight-card insight-card-highlight">
                    <div class="insight-card-header highlight">
                        <span class="material-symbols-outlined">trophy</span>
                        <span>참여율 TOP 영상</span>
                    </div>
                    <div class="insight-value-large" id="insight-top-engagement">-</div>
                </div>
            </div>
            
            <!-- 하단 2컬럼 레이아웃 -->
            <div class="insights-bottom">
                <!-- 콘텐츠 제작 팁 -->
                <div class="insights-tips-section">
                    <h2>
                        <span class="material-symbols-outlined">auto_awesome</span>
                        콘텐츠 제작 팁
                    </h2>
                    <div class="tips-list" id="insight-tips">
                        데이터를 분석 중입니다...
                    </div>
                </div>
                
                <!-- TOP 영상 리스트 -->
                <div class="insights-top-videos">
                    <h3>참여율 TOP 영상</h3>
                    <ul class="top-videos-list" id="insight-top-videos-list">
                        <!-- JS로 동적 생성 -->
                    </ul>
                </div>
            </div>
        </div>

        <div id="loading" class="loading" style="display: none;">
            <div class="loading-spinner"></div>
            <p>인기 영상을 불러오는 중...</p>
        </div>

        <div id="error" class="error-message" style="display: none;">
            <h3>⚠️ 오류 발생</h3>
            <p id="error-text"></p>
        </div>

        <div id="video-list" class="video-list"></div>

        <!-- 즐겨찾기 섹션 -->
        <div id="favorites-section" class="favorites-section" style="display: none;">
            <div class="folders-header">
                <h2>
                    <span class="material-symbols-outlined">folder_special</span>
                    내 즐겨찾기 폴더
                </h2>
                <button class="btn-create-folder" onclick="showCreateFolderModal()">
                    <span class="material-symbols-outlined">create_new_folder</span>
                    새 폴더
                </button>
            </div>
            <div id="folders-list" class="folders-list"></div>
            <div id="folder-videos" class="folder-videos" style="display: none;">
                <div class="folder-videos-header">
                    <button class="btn-back" onclick="showFoldersList()">
                        <span class="material-symbols-outlined">arrow_back</span>
                        폴더 목록
                    </button>
                    <h3 id="current-folder-name"></h3>
                    <button class="btn-delete-folder" onclick="deleteCurrentFolder()">
                        <span class="material-symbols-outlined">delete</span>
                    </button>
                </div>
                <div id="folder-video-list" class="video-list"></div>
            </div>
        </div>
    </div>

    <!-- 폴더 생성 모달 -->
    <div id="create-folder-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>새 폴더 만들기</h3>
                <button class="modal-close" onclick="hideCreateFolderModal()">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="folder-name">폴더명</label>
                    <input type="text" id="folder-name" placeholder="폴더명을 입력하세요">
                </div>
                <div class="form-group">
                    <label for="folder-desc">설명 (선택)</label>
                    <input type="text" id="folder-desc" placeholder="폴더 설명">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="hideCreateFolderModal()">취소</button>
                <button class="btn-confirm" onclick="createFolder()">만들기</button>
            </div>
        </div>
    </div>

    <!-- 폴더 선택 모달 -->
    <div id="select-folder-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>폴더에 추가</h3>
                <button class="modal-close" onclick="hideSelectFolderModal()">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div class="modal-body">
                <div id="folder-select-list" class="folder-select-list"></div>
                <button class="btn-new-folder-inline" onclick="hideSelectFolderModal(); showCreateFolderModal();">
                    <span class="material-symbols-outlined">add</span>
                    새 폴더 만들기
                </button>
            </div>
        </div>
    </div>

    <!-- 채팅 UI -->
    <div class="chat-container">
        <div class="chat-header" onclick="toggleChat()">
            <div class="chat-header-left">
                <div class="chat-icon">
                    <span class="material-symbols-outlined">chat</span>
                </div>
                <div>
                    <div class="chat-title">실시간 채팅</div>
                    <div class="chat-online">
                        <span class="chat-online-dot"></span>
                        익명 채팅
                    </div>
                </div>
            </div>
            <div class="chat-controls">
                <button class="btn-chat-control btn-minimize">
                    <span class="material-symbols-outlined">expand_more</span>
                </button>
            </div>
        </div>
        
        <div class="chat-messages" id="chat-messages">
            <!-- 메시지가 여기에 동적으로 추가됩니다 -->
        </div>
        
        <div class="chat-input-container">
            <div class="chat-input-wrapper">
                <input 
                    type="text" 
                    id="chat-input" 
                    class="chat-input" 
                    placeholder="메시지를 입력하세요..."
                    disabled
                    maxlength="500"
                >
                <button id="btn-send" class="btn-send" onclick="sendMessage()" disabled>
                    <span class="material-symbols-outlined">send</span>
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    <script th:src="@{/js/youtube-revenue.js}"></script>
    <script th:src="@{/js/youtube-chat.js}"></script>
    <script th:src="@{/js/youtube-popular.js}"></script>
    <script th:src="@{/js/youtube-favorites.js}"></script>
</body>
</html>
